generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model PurchaseRequest {
  id          String       @id @default(cuid())
  requester   String
  costCenter  String
  total       Int
  status      PRStatus     @default(OPEN)
  items       Json
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  assessments Assessment[]
}

model Assessment {
  id        String          @id @default(cuid())
  prId      String
  decision  Decision
  reason    String
  traceJson Json
  createdAt DateTime        @default(now())
  pr        PurchaseRequest @relation(fields: [prId], references: [id], onDelete: Cascade)
}

model PolicyConfig {
  id         String @id @default(cuid())
  costCenter String @unique
  budget     Int
  perItemCap Int
}

enum PRStatus {
  OPEN
  APPROVED
  REJECTED
}

enum Decision {
  APPROVE
  REJECT
  NEEDS_INFO
}
